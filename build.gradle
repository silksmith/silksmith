plugins {
	id "com.jfrog.bintray" version "1.1"
	id "com.jfrog.artifactory" version "3.0.1"
	id "com.gradle.plugin-publish" version "0.9.0"
}
apply plugin: 'groovy'
apply plugin: 'eclipse'
apply plugin: 'maven'
apply plugin: 'idea'
apply plugin: 'java'
apply plugin: 'maven-publish'
sourceCompatibility = 1.8
targetCompatibility = 1.8


version = "0.4.0-SNAPSHOT"
group = "io.silksmith"

repositories {
    mavenCentral()
}
ext{
	 closureCompilerVersion = 'v20141215'
}
dependencies {
    compile gradleApi()
    compile localGroovy()

    compile 'org.eclipse.jetty:jetty-server:9.3.0.M1'
	compile 'org.eclipse.jgit:org.eclipse.jgit:3.5.3.201412180710-r'

	compile "com.google.javascript:closure-compiler:$closureCompilerVersion"

	compile 'org.jruby:jruby-complete:1.7.17'
	compile 'org.webjars:mocha:2.0.1'
	compile 'org.seleniumhq.selenium:selenium-java:2.45.0'
	compile 'org.seleniumhq.selenium:selenium-chrome-driver:2.45.0'

	testCompile 'junit:junit:4.11'

}
task wrapper(type: Wrapper) {
	gradleVersion ="2.3"
	distributionUrl = "http://services.gradle.org/distributions/gradle-$gradleVersion-all.zip"
}
publishing {
	publications {
		maven(MavenPublication) {
			from components.java
		}
	}
	repositories {
		maven {
			name 'jcenterSnapshot'
			// change to point to your repo, e.g. http://my.org/repo
			url "http://oss.jfrog.org/artifactory/oss-snapshot-local"
			
			credentials {
				
				username = bintray_net_user
				password = bintray_net_key
			}
		}
	}
}
artifactory {
	contextUrl = "${artifactory_contextUrl}"   //The base Artifactory URL if not overridden by the publisher/resolver
	publish {
		repository {
			repoKey = 'oss-snapshot-local'
			username = "${artifactory_user}"
			password = "${artifactory_password}"
			maven = true
			 
		}
		defaults {
			//This closure defines defaults for all 'artifactoryPublish' tasks of all projects the plugin is applied to
			publications ('maven')
		}
	}
}

bintray {
		
	user = bintray_net_user
	key = bintray_net_key
	
	
	publications = ["maven"]
	pkg {
		repo = 'maven'
		userOrg = "silksmith-io"
		name = "silksmith"
		websiteUrl = 'https://github.com/silksmith/silksmith'
		issueTrackerUrl = 'https://github.com/silksmith/silksmith/issues'
		vcsUrl = 'https://github.com/silksmith/silksmith.git'
		licenses = ['MIT']
		publicDownloadNumbers = true
		//version.attributes = [ 'gradle-plugin': 'io.silksmith:silksmith:silksmith' ]
	}
}

pluginBundle {
	website = 'http://silksmith.io'
	vcsUrl = 'https://github.com/silksmith/silksmith'
	description = 'JS and CSS with Gradle'
	tags = ['js', 'closure compiler', 'javascript', 'scss', 'css', 'dependency resolution']
  
	plugins {
	  silksmithPlugin {
		id = 'io.silksmith.plugin'
		displayName = 'JS and SASS compiling'
	  },
	  silksmithAngularPlugin {
			id = 'io.silksmith.angular-plugin'
			displayName = 'Angular Support for Silksmith'
		  }
	  /*silksmithBasePlugin {
		  id = 'io.silksmith.base-plugin'
		  displayName = 'All plugins'
	  }*/
	}
}